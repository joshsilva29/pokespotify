<!DOCTYPE html>
<html>

<head>
  <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
  <title>Pokémonify</title>
  <script type="text/javascript" src="/index.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Mulish&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <script src="/Applications/Visual Studio Code.app/Contents/Resources/app/out/vs/code/electron-browser/workbench/workbench.htmlhttps://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="login">
      <h1 id="title">POKÉMONIFY</h1>
      <h2 id="title_caption">What Pokémon are you based on your listening history?</h2>
      <a id="login_button" href="/login" class="btn btn-primary">Spotify Login</a>
    </div>
    <div id="loggedin" display="none">
      <h1 style="color: white">young money nicki minaj justin</h1>
      <h2 id="yup" style="color: white"></h2>
      <h3 id="abc" style="color: white"></h3>
      <h4 id="def" style="color: white"></h4>
      <h2 id="ghi" style="color: white"></h2>
      <h2 id="jkl" style="color: white">uhhhh</h2>
      <h2 id="mood" style="color: white"></h2>
      <h2 id="energy" style="color: white"></h2>
      <h2 id="acoustic" style="color: white"></h2>
    </div>
    <div class="info">
      <h4 id="login-credits" >Developed by Joshua Silva</h4>
    </div>
</body>

<script src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
<script type="text/javascript">
    var url = window.location.href;

    /* 
    This first part is checking if the current page is the page
    generated AFTER the callback function. If it isn't, no code
    executes.
    */
    document.getElementById("abc").innerHTML = "made it to this place";

    if (url.includes("logged")) {
      document.getElementById("yup").innerHTML = "BUT DO WE MAKE IT HERE";
      $('#loggedin').show();
      $('#login').hide();
      document.getElementById("yup").innerHTML = url;

      async function getValues() {
        const values_response = await fetch('/json_fetch');
        const values_json = await values_response.json();
        return values_json;
      }

      getValues().then(
        function(result) {

          const mood = result.mood;
          const energy = result.energy;
          const acoustic = result.acoustic;

          const short_mood = mood[0];
          const medium_mood = mood[1];
          const long_mood = mood[2];

          var mood_str = "short mood: " + short_mood + ", medium mood: " + medium_mood + 
            ", long mood: " + long_mood;

          const short_energy = energy[0];
          const medium_energy = energy[1];
          const long_energy = energy[2];

          var energy_str = "short energy: " + short_energy + ", medium energy: " + medium_energy + 
            ", long energy: " + long_energy;

          const short_acoustic = acoustic[0];
          const medium_acoustic = acoustic[1];
          const long_acoustic = acoustic[2];

          var acoustic_str = "short acoustic: " + short_acoustic + ", medium acoustic: " + medium_acoustic + 
            ", long acoustic: " + long_acoustic;

          document.getElementById("mood").innerHTML = mood_str;
          document.getElementById("energy").innerHTML = energy_str;
          document.getElementById("acoustic").innerHTML = acoustic_str;
        },
        function(error) {
          document.getElementById("jkl").innerHTML = "aint no way???? " + error;
        }
      );

    } else {
      $('#login').show();
      $('#loggedin').hide();
    }
</script>

</html>